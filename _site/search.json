{
  "articles": [
    {
      "path": "Ask_A_Manager_Survey.html",
      "title": "Ask A Manager Survey",
      "description": "This post is about the 2021 Ask A Manager Survey analysis. It provides an overview of the data analysis process attempting to fit a linear regression model to explain variances in reported salaries among the respondents\n",
      "author": [
        {
          "name": {},
          "url": "https://www.linkedin.com/in/sivuyile-nzimeni-98006ba0/"
        }
      ],
      "date": "December 25, 2021",
      "contents": "\r\n\r\nContents\r\nINTRODUCTION\r\nREPRODUCIBILITY\r\nOUT OF SAMPLE TESTING\r\n\r\nLASSO REGRESSION\r\nIMPORTANT VARIABLE EXTRACTION\r\nTIDYMODELS: A CLEAN INTERFACE FOR MACHING LEARNING\r\n\r\nRESULTS\r\nTraining Dataset\r\nTest Dataset\r\n\r\nCONCLUSION\r\nREFERENCES\r\n\r\nINTRODUCTION\r\nIn early 2021, the Ask A Manager blogsite ran their annual salary survey. The survey responses are stored on googlesheets, making the data accessible to all interested. In a previous post, we discussed data pre-processing and feature selection method. This post focuses two aspects,namely, 1) Reproducibility and 2) Out-of-Sample Testing.\r\nREPRODUCIBILITY\r\nIn the previous post, we detailed the feature selection method by regularised regreesion, specifically, LASSO regression. In this post, we will attempt to reproduce the feature selection method.\r\nOUT OF SAMPLE TESTING\r\nIn this post, we will also follow the traditional machine learning workflow including, splitting the data into a training and testing samples, fitting a model, cross-validation and finally fitting the model on the out-of-sample dataset(testing dataset). This approach can inform us about the model’s parsimony. In other words, can the model perform well on an unknown sample.\r\n\r\n\r\n\r\n\r\n\r\n\r\nLASSO REGRESSION\r\nAs mentioned above, the data cleaning process was detailed on an earlier post. It is worth highlighting that the dataset contained several dummy variables indicating various respondent attributes such as job_title, industry, city, age group etc. Our dependent variable is the annual salary. Given the large number of independent variables. In the code below, we fit a LASSO regression model.\r\n\r\n\r\nX <- model.matrix(new_annual_salary ~.,Salary_Train)[,-1]\r\nY <- log(Salary_Train$new_annual_salary)\r\n\r\nlasso <- glmnet(x=X,\r\n       y= Y,\r\n       alpha = 1)\r\n\r\n\r\n\r\nIMPORTANT VARIABLE EXTRACTION\r\nThe resulting object is a list of class “glmnet”. Essentially, the results contain all the iterations through alpha and to find the minimum lambda. As such, there are several results in the object. We are primarily interested in extracting the remaining variables at minimum lambda along with their coeffiecients. The vip package can automate the plotting of the results. However, we want to extract the variables names in order to fit them on our training test. There is probably a package to assist with this step somewhere in the wild, however, we haven’t found it yet. Luckily in R, we can write custom functions. The code below details the variable_extractor function.\r\n\r\n\r\nvariable_extractor <- function(a_list){\r\n  min_lambda <- data.frame(best_lambda =a_list[[\"lambda\"]]==min(a_list[[\"lambda\"]]))\r\n  min_lambda <- cbind.data.frame(data.frame(index = rownames(min_lambda)),\r\n                                 min_lambda)\r\n  min_lambda <- min_lambda %>% \r\n    filter(best_lambda == TRUE)\r\n  min_lambda <- as.double(unique(min_lambda$index))\r\n  lasso_variables <- as.matrix(coef(a_list))|>data.frame()\r\n  lasso_variables <- cbind.data.frame(variables = rownames(lasso_variables),\r\n                                      lasso_variables)\r\n  lasso_variables <- tibble(lasso_variables)\r\n  lasso_variables <- lasso_variables[,c(1,min_lambda+1)]\r\n  names(lasso_variables) <- c(\"variable\",\"importance\")\r\n  lasso_variables <- lasso_variables %>% \r\n    filter(variable != \"(Intercept)\",\r\n           importance != 0.00000000) %>% \r\n    arrange(desc(importance))\r\n\r\n  return(lasso_variables)\r\n}\r\n\r\nlasso_variable <- variable_extractor(lasso)\r\n\r\n\r\n\r\nThe function takes a list of attribute “glmnet”. Thereafter, we find the smallest lambda. In addition, we extract all the coefficients from the object and store them as a wide dataframe. The dataframe is subset to only contain the variable name along with the coefficients of the smallest lambda value. We discard the intercept and variable with coefficients that are equal to 0.0000000. The final output is identical to the variables extracted by the vip package. Finally, we subset both the training dataset and the testing dataset to only contain the selected independent variables. Since the outcome variable is expressed in USD terms, we log the outcome variable.\r\n\r\n\r\n\r\nTIDYMODELS: A CLEAN INTERFACE FOR MACHING LEARNING\r\nThe R programming language doesn’t not lack methods for running machine learning algorithms, it is after all, a statistical programming language. The tidymodels metapackage aims to provide a standard interface for modelling and machine learning using tidyverse principles. Below, we use the package to complete a number of steps including, crossfold_validation, model specification, fitting on the resamples and finally fitting the model on the training dataset.\r\n\r\n\r\nSalary_Folds <- vfold_cv(Salary_Train)\r\n\r\nlm_spec <- linear_reg(engine = \"lm\")\r\n\r\nlm_recipe <- recipe(new_annual_salary ~.,Salary_Train) %>% \r\n  step_nzv(all_predictors())\r\n\r\nlm_wf <- workflow(lm_recipe,lm_spec)\r\n\r\ndoParallel::registerDoParallel(cores = 10)\r\nctrl_preds <- control_resamples(save_pred = TRUE)\r\ncv_results <- fit_resamples(lm_wf,Salary_Folds,control = ctrl_preds)\r\n\r\nlm_wf <- fit(lm_wf,Salary_Train)\r\n\r\ncollect_metrics(cv_results,summarize = FALSE) %>% \r\n  filter(.metric == \"rsq\") %>% \r\n  summarise(avg_estimate = mean(.estimate),\r\n            .groups = \"drop\")\r\n\r\n\r\n# A tibble: 1 × 1\r\n  avg_estimate\r\n         <dbl>\r\n1        0.270\r\n\r\nAcross all 10 validation folds, the linear regression model’s adjusted R-square averaged 0.272. It is possible to tune the parameters and use battery of other machine learning models to improve performance. In the previous post, we utilised random forest to try an improve the model. Despite, requiring additional computational power, the increases in peformance were marginal to neglible.\r\nAt this point, we have completed our first objective. We are able to reproduce the LASSO regresison results in the previous post. The next objective is to determine the parsimony of the model. Here, we fit model on the test data.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nRESULTS\r\nTraining Dataset\r\n\r\n\r\n@import url(\"https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\r\n@import url(\"https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\r\n@import url(\"https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#lucizqjgfl .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: none;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#lucizqjgfl .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#lucizqjgfl .gt_bottom_border {\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_col_headings {\r\n  border-top-style: none;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 1px;\r\n  border-bottom-color: #334422;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#lucizqjgfl .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#lucizqjgfl .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#lucizqjgfl .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#lucizqjgfl .gt_column_spanner {\r\n  border-bottom-style: none;\r\n  border-bottom-width: 1px;\r\n  border-bottom-color: #334422;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 5px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#lucizqjgfl .gt_group_heading {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#lucizqjgfl .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#lucizqjgfl .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#lucizqjgfl .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#lucizqjgfl .gt_row {\r\n  padding-top: 7px;\r\n  padding-bottom: 7px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#lucizqjgfl .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lucizqjgfl .gt_stub_row_group {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  vertical-align: top;\r\n}\r\n\r\n#lucizqjgfl .gt_row_group_first td {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#lucizqjgfl .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lucizqjgfl .gt_first_summary_row {\r\n  border-top-style: solid;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_first_summary_row.thick {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#lucizqjgfl .gt_last_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lucizqjgfl .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#lucizqjgfl .gt_table_body {\r\n  border-top-style: none;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #FFFFFF;\r\n}\r\n\r\n#lucizqjgfl .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lucizqjgfl .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#lucizqjgfl .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#lucizqjgfl .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#lucizqjgfl .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#lucizqjgfl .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#lucizqjgfl .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#lucizqjgfl .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#lucizqjgfl .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#lucizqjgfl .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#lucizqjgfl .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 75%;\r\n  vertical-align: 0.4em;\r\n}\r\n\r\n#lucizqjgfl .gt_asterisk {\r\n  font-size: 100%;\r\n  vertical-align: 0;\r\n}\r\n\r\n#lucizqjgfl .gt_slash_mark {\r\n  font-size: 0.7em;\r\n  line-height: 0.7em;\r\n  vertical-align: 0.15em;\r\n}\r\n\r\n#lucizqjgfl .gt_fraction_numerator {\r\n  font-size: 0.6em;\r\n  line-height: 0.6em;\r\n  vertical-align: 0.45em;\r\n}\r\n\r\n#lucizqjgfl .gt_fraction_denominator {\r\n  font-size: 0.6em;\r\n  line-height: 0.6em;\r\n  vertical-align: -0.05em;\r\n}\r\nLinear Regression Model: Training Dataset\r\n    Depedent Variable: log(Annual Salary(USD))\r\n    Characteristic\r\n      Beta (SE)1,2\r\n    (Intercept)\r\n11***\r\n(0.022)years_of_experience_in_field_X21...30.years\r\n0.37***\r\n(0.023)job_title_director\r\n0.33***\r\n(0.013)years_of_experience_in_field_X11...20.years\r\n0.27***\r\n(0.019)city_york\r\n0.26***\r\n(0.016)highest_level_of_education_completed_PhD\r\n0.26***\r\n(0.017)industry_government\r\n0.26**\r\n(0.086)industry_computing\r\n0.21\r\n(0.241)job_title_engineer\r\n0.24***\r\n(0.016)years_of_experience_in_field_X8...10.years\r\n0.20***\r\n(0.020)job_title_senior\r\n0.16***\r\n(0.012)years_of_experience_in_field_X5.7.years\r\n0.12***\r\n(0.019)job_title_manager\r\n0.11***\r\n(0.010)how_old_are_you_X45.54\r\n0.09***\r\n(0.019)how_old_are_you_X35.44\r\n0.09***\r\n(0.018)industry_health\r\n0.12\r\n(0.081)industry_engineering\r\n0.08***\r\n(0.017)industry_finance\r\n0.26\r\n(0.182)how_old_are_you_X25.34\r\n0.06**\r\n(0.017)industry_tech\r\n0.08\r\n(0.241)highest_level_of_education_completed_Master.s.degree\r\n0.04***\r\n(0.008)job_title_analyst\r\n0.04*\r\n(0.015)industry_administration\r\n0.02\r\n(0.093)industry_banking\r\n-0.19\r\n(0.183)years_of_experience_in_field_X2...4.years\r\n0.01\r\n(0.018)industry_care\r\n-0.04\r\n(0.081)industry_accounting\r\ngender_Woman\r\n-0.03***\r\n(0.009)overall_years_of_professional_experience_X11...20.years\r\n-0.09***\r\n(0.023)overall_years_of_professional_experience_X21...30.years\r\n-0.09***\r\n(0.023)overall_years_of_professional_experience_X8...10.years\r\n-0.10***\r\n(0.023)race_White\r\n-0.11***\r\n(0.010)overall_years_of_professional_experience_X5.7.years\r\n-0.14***\r\n(0.024)overall_years_of_professional_experience_X2...4.years\r\n-0.18***\r\n(0.023)industry_nonprofits\r\n-0.18***\r\n(0.014)industry_education\r\n-0.19***\r\n(0.013)job_title_assistant\r\n-0.21***\r\n(0.015)highest_level_of_education_completed_Some.college\r\n-0.22***\r\n(0.014)industry_public\r\n-0.25***\r\n(0.052)Adjusted R-square: 0.2732\r\n    1 *p<0.05; **p<0.01; ***p<0.001\r\n    2 SE = Standard Error\r\n    \r\n\r\nTest Dataset\r\n\r\n\r\n@import url(\"https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\r\n@import url(\"https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\r\n@import url(\"https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\r\nhtml {\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r\n}\r\n\r\n#qxwdrebquv .gt_table {\r\n  display: table;\r\n  border-collapse: collapse;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  background-color: #FFFFFF;\r\n  width: auto;\r\n  border-top-style: none;\r\n  border-top-width: 2px;\r\n  border-top-color: #A8A8A8;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #A8A8A8;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_heading {\r\n  background-color: #FFFFFF;\r\n  text-align: center;\r\n  border-bottom-color: #FFFFFF;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_title {\r\n  color: #333333;\r\n  font-size: 125%;\r\n  font-weight: initial;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-color: #FFFFFF;\r\n  border-bottom-width: 0;\r\n}\r\n\r\n#qxwdrebquv .gt_subtitle {\r\n  color: #333333;\r\n  font-size: 85%;\r\n  font-weight: initial;\r\n  padding-top: 0;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-color: #FFFFFF;\r\n  border-top-width: 0;\r\n}\r\n\r\n#qxwdrebquv .gt_bottom_border {\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_col_headings {\r\n  border-top-style: none;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 1px;\r\n  border-bottom-color: #334422;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_col_heading {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 6px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#qxwdrebquv .gt_column_spanner_outer {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: normal;\r\n  text-transform: inherit;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n}\r\n\r\n#qxwdrebquv .gt_column_spanner_outer:first-child {\r\n  padding-left: 0;\r\n}\r\n\r\n#qxwdrebquv .gt_column_spanner_outer:last-child {\r\n  padding-right: 0;\r\n}\r\n\r\n#qxwdrebquv .gt_column_spanner {\r\n  border-bottom-style: none;\r\n  border-bottom-width: 1px;\r\n  border-bottom-color: #334422;\r\n  vertical-align: bottom;\r\n  padding-top: 5px;\r\n  padding-bottom: 5px;\r\n  overflow-x: hidden;\r\n  display: inline-block;\r\n  width: 100%;\r\n}\r\n\r\n#qxwdrebquv .gt_group_heading {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#qxwdrebquv .gt_empty_group_heading {\r\n  padding: 0.5px;\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  border-top-style: solid;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  vertical-align: middle;\r\n}\r\n\r\n#qxwdrebquv .gt_from_md > :first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n#qxwdrebquv .gt_from_md > :last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n#qxwdrebquv .gt_row {\r\n  padding-top: 7px;\r\n  padding-bottom: 7px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  margin: 10px;\r\n  border-top-style: solid;\r\n  border-top-width: 1px;\r\n  border-top-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 1px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 1px;\r\n  border-right-color: #D3D3D3;\r\n  vertical-align: middle;\r\n  overflow-x: hidden;\r\n}\r\n\r\n#qxwdrebquv .gt_stub {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#qxwdrebquv .gt_stub_row_group {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  font-size: 100%;\r\n  font-weight: initial;\r\n  text-transform: inherit;\r\n  border-right-style: solid;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  vertical-align: top;\r\n}\r\n\r\n#qxwdrebquv .gt_row_group_first td {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#qxwdrebquv .gt_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#qxwdrebquv .gt_first_summary_row {\r\n  border-top-style: solid;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_first_summary_row.thick {\r\n  border-top-width: 2px;\r\n}\r\n\r\n#qxwdrebquv .gt_last_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_grand_summary_row {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  text-transform: inherit;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#qxwdrebquv .gt_first_grand_summary_row {\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  border-top-style: double;\r\n  border-top-width: 6px;\r\n  border-top-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_striped {\r\n  background-color: rgba(128, 128, 128, 0.05);\r\n}\r\n\r\n#qxwdrebquv .gt_table_body {\r\n  border-top-style: none;\r\n  border-top-width: 2px;\r\n  border-top-color: #D3D3D3;\r\n  border-bottom-style: solid;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #FFFFFF;\r\n}\r\n\r\n#qxwdrebquv .gt_footnotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_footnote {\r\n  margin: 0px;\r\n  font-size: 90%;\r\n  padding-left: 4px;\r\n  padding-right: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#qxwdrebquv .gt_sourcenotes {\r\n  color: #333333;\r\n  background-color: #FFFFFF;\r\n  border-bottom-style: none;\r\n  border-bottom-width: 2px;\r\n  border-bottom-color: #D3D3D3;\r\n  border-left-style: none;\r\n  border-left-width: 2px;\r\n  border-left-color: #D3D3D3;\r\n  border-right-style: none;\r\n  border-right-width: 2px;\r\n  border-right-color: #D3D3D3;\r\n}\r\n\r\n#qxwdrebquv .gt_sourcenote {\r\n  font-size: 90%;\r\n  padding-top: 4px;\r\n  padding-bottom: 4px;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n}\r\n\r\n#qxwdrebquv .gt_left {\r\n  text-align: left;\r\n}\r\n\r\n#qxwdrebquv .gt_center {\r\n  text-align: center;\r\n}\r\n\r\n#qxwdrebquv .gt_right {\r\n  text-align: right;\r\n  font-variant-numeric: tabular-nums;\r\n}\r\n\r\n#qxwdrebquv .gt_font_normal {\r\n  font-weight: normal;\r\n}\r\n\r\n#qxwdrebquv .gt_font_bold {\r\n  font-weight: bold;\r\n}\r\n\r\n#qxwdrebquv .gt_font_italic {\r\n  font-style: italic;\r\n}\r\n\r\n#qxwdrebquv .gt_super {\r\n  font-size: 65%;\r\n}\r\n\r\n#qxwdrebquv .gt_footnote_marks {\r\n  font-style: italic;\r\n  font-weight: normal;\r\n  font-size: 75%;\r\n  vertical-align: 0.4em;\r\n}\r\n\r\n#qxwdrebquv .gt_asterisk {\r\n  font-size: 100%;\r\n  vertical-align: 0;\r\n}\r\n\r\n#qxwdrebquv .gt_slash_mark {\r\n  font-size: 0.7em;\r\n  line-height: 0.7em;\r\n  vertical-align: 0.15em;\r\n}\r\n\r\n#qxwdrebquv .gt_fraction_numerator {\r\n  font-size: 0.6em;\r\n  line-height: 0.6em;\r\n  vertical-align: 0.45em;\r\n}\r\n\r\n#qxwdrebquv .gt_fraction_denominator {\r\n  font-size: 0.6em;\r\n  line-height: 0.6em;\r\n  vertical-align: -0.05em;\r\n}\r\nLinear Regression Model: Test Dataset\r\n    Depedent Variable: log(Annual Salary(USD))\r\n    Characteristic\r\n      Beta (SE)1,2\r\n    (Intercept)\r\n11***\r\n(0.039)years_of_experience_in_field_X21...30.years\r\n0.48***\r\n(0.041)job_title_director\r\n0.31***\r\n(0.023)years_of_experience_in_field_X11...20.years\r\n0.37***\r\n(0.033)city_york\r\n0.22***\r\n(0.028)highest_level_of_education_completed_PhD\r\n0.27***\r\n(0.030)industry_government\r\n0.27*\r\n(0.119)industry_computing\r\n0.07\r\n(0.219)job_title_engineer\r\n0.24***\r\n(0.027)years_of_experience_in_field_X8...10.years\r\n0.32***\r\n(0.034)job_title_senior\r\n0.16***\r\n(0.020)years_of_experience_in_field_X5.7.years\r\n0.20***\r\n(0.032)job_title_manager\r\n0.15***\r\n(0.017)how_old_are_you_X45.54\r\n0.16***\r\n(0.035)how_old_are_you_X35.44\r\n0.13***\r\n(0.032)industry_health\r\n0.26\r\n(0.146)industry_engineering\r\n0.09**\r\n(0.029)industry_finance\r\n0.25\r\n(0.488)how_old_are_you_X25.34\r\n0.09**\r\n(0.030)industry_tech\r\n0.19\r\n(0.219)highest_level_of_education_completed_Master.s.degree\r\n0.05***\r\n(0.014)job_title_analyst\r\n0.08**\r\n(0.027)industry_administration\r\n-0.02\r\n(0.133)industry_banking\r\n-0.52\r\n(0.706)years_of_experience_in_field_X2...4.years\r\n0.09**\r\n(0.032)industry_care\r\n-0.18\r\n(0.147)industry_accounting\r\n0.28\r\n(0.509)gender_Woman\r\n-0.03\r\n(0.016)overall_years_of_professional_experience_X11...20.years\r\n-0.19***\r\n(0.041)overall_years_of_professional_experience_X21...30.years\r\n-0.21***\r\n(0.041)overall_years_of_professional_experience_X8...10.years\r\n-0.18***\r\n(0.042)race_White\r\n-0.12***\r\n(0.017)overall_years_of_professional_experience_X5.7.years\r\n-0.21***\r\n(0.042)overall_years_of_professional_experience_X2...4.years\r\n-0.24***\r\n(0.042)industry_nonprofits\r\n-0.21***\r\n(0.024)industry_education\r\n-0.19***\r\n(0.022)job_title_assistant\r\n-0.24***\r\n(0.026)highest_level_of_education_completed_Some.college\r\n-0.17***\r\n(0.025)industry_public\r\n-0.23*\r\n(0.092)Adjusted R-square: 0.2624\r\n    1 *p<0.05; **p<0.01; ***p<0.001\r\n    2 SE = Standard Error\r\n    \r\n\r\nCONCLUSION\r\nThe model performs well on an out-of-sample dataset with year of experience (21 - 30 years), job title (Director) and highest level of education (PhD) being among the most important predictors of annual salary. Provided the questions utilised in 2022 are similar or identical to the 2021 survey, the model above can be evaluated on the 2022 survey results.\r\nREFERENCES\r\nSilge,J. 2021.Fit and predict with tidymodels for #TidyTuesday bird baths in Australia. Available From: https://juliasilge.com/blog/bird-baths/ (Accessed 24 December 2021).\r\nWickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686\r\nSam Firke (2021). janitor: Simple Tools for Examining and Cleaning Dirty Data. R package version 2.1.0. https://CRAN.R-project.org/package=janitor\r\nKuhn et al., (2020). Tidymodels: a collection of packages for modeling and machine learning using tidyverse principles. https://www.tidymodels.org\r\nJerome Friedman, Trevor Hastie, Robert Tibshirani (2010). Regularization Paths for Generalized Linear Models via Coordinate Descent. Journal of Statistical Software, 33(1), 1-22. https://www.jstatsoft.org/v33/i01/.\r\nRichard Iannone, Joe Cheng and Barret Schloerke (2021). gt: Easily Create Presentation-Ready Display Tables. R package version 0.3.1. https://CRAN.R-project.org/package=gt\r\nThomas Mock (2021). gtExtras: A Collection of Helper Functions for the gt Package. R package version 0.2.2.11. https://github.com/jthomasmock/gtExtras\r\nSjoberg DD, Whiting K, Curry M, Lavery JA, Larmarange J. Reproducible summary tables with the gtsummary package. The R Journal 2021;13:570–80. https://doi.org/10.32614/RJ-2021-053.\r\n\r\n\r\n\r\n",
      "last_modified": "2022-04-09T16:49:29+02:00"
    },
    {
      "path": "Cars_SA.html",
      "title": "South African Car Prices",
      "description": "This post details the data scraping process for obtaining data from a South African online vehicle marketplate. In addition, the post shares the results of a linear regression model to estimate determinants of vehicle prices.\n",
      "author": [
        {
          "name": {},
          "url": "https://www.linkedin.com/in/sivuyile-nzimeni-98006ba0/"
        }
      ],
      "date": "February 28, 2022",
      "contents": "\r\n\r\nContents\r\nINTRODUCTION\r\nWEB SCRAPING\r\nIMPORTING THE DATA\r\nDATA PREPROCESSING\r\nLASSO IT ONCE, LASSO IT UNTIL YOU CAN ALSO NO MORE\r\nCROSS VALIDATION\r\n\r\nTESTING PERFORMANCE OF A OUT-OF-SAMPLE SET\r\nCONCLUSION\r\nREFERENCE\r\n\r\nINTRODUCTION\r\nSouth Africa has a plethora of online vehicle marketplaces. Often, their pool of vehicles for sale are usually > 50 000 on a daily basis. The vehicle listings offer a vast amount of car related data. Naturally, web-scraping the data provides an opportunity to fit a Machine-Learning model and endless exploration for petrol-heads (such as myself). Nearly all the online vehicle marketplaces have restrictive Terms and Conditions deterring the use of their data for commercial purposes and bombarding of their servers through web scrapping among other restrictions. Unfortunately, this means web scraping script cannot be shared in this post as it may reveal where the data were obtained, methodology of scraping the data etc. In addition, the website of the online vehicle marketplace will not be revealed.\r\nWEB SCRAPING\r\nTo respect the Terms of Conditions, the scraping was throttled through the use of base R’s rpois function along with the Sys.sleep() function. Combining the two functions results in non-normal distribution of system sleep. System sleep essentially pauses R for the specified period. This step in the scrapping process is important to avoid sending to many requests to a website, perhaps, hoarding server capacity for other users. In this instance,scrapping all the webpages and pulling all listed vehicles on the day(2021-09-02), took 10 hours.\r\n\r\n\r\npause <- function(){\r\n  Sys.sleep(rpois(1,60))\r\n  print(paste0(\"Proceeding to the next page...\"))\r\n  }\r\n\r\n\r\n\r\nIMPORTING THE DATA\r\nBelow, we import the data and use dplyr::glimpse function to see the number of columns and values. The dataset contains a few important variables including the car_name and vehicle manufacturer. It is worth noting that the car_name variable appears to a free text field where the person listing the vehicle can modify the car name to include marketing terms such as: “excellent condition”,“reduce price” etc.\r\n\r\n\r\nCar_Data <- read_csv(file =\"./2021-09-03_MANY_VEHICLES_Clean_Db.csv\") %>% \r\n  clean_names()\r\n\r\nglimpse(Car_Data)\r\n\r\n\r\nRows: 62,196\r\nColumns: 10\r\n$ car_name             <chr> \"9-3 Sport 2.0 Linear Lpt\", \"S40 2.0T\",…\r\n$ vehicle_manufacturer <chr> \"Saab\", \"Volvo\", \"Volvo\", \"Hyundai\", \"V…\r\n$ year                 <dbl> 2007, 1999, 2001, 2000, 2000, 1998, 199…\r\n$ mileage              <dbl> 200000, 285000, 271000, 125000, 190000,…\r\n$ price                <dbl> 13700, 18900, 18900, 20000, 20900, 2190…\r\n$ fuel_type            <chr> \"Petrol\", \"Petrol\", \"Petrol\", \"Petrol\",…\r\n$ transmission         <chr> \"Manual\", \"Manual\", \"Manual\", \"Manual\",…\r\n$ dealership           <chr> \"Mahala Motors\", \"WeBuyCars Midstream\",…\r\n$ city_town            <chr> \"Klerksdorp\", \"Centurion\", \"Cape Town\",…\r\n$ province             <chr> \"North West Province\", \"Gauteng\", \"West…\r\n\r\nSimilarly, the free text field, also means that vehicle naming conventions deviate from the vehicle manufacturer specifications. Other text variables also contain these anomalous changes in text. The code below demonstrates an example of idiosyncrasies.\r\n\r\n\r\nCar_Data %>% \r\n  filter(str_detect(car_name,\"condition\"))\r\n\r\n\r\n# A tibble: 4 × 10\r\n  car_name             vehicle_manufac…  year mileage  price fuel_type\r\n  <chr>                <chr>            <dbl>   <dbl>  <dbl> <chr>    \r\n1 Focus Excellent con… Ford              2008  305000  69950 Petrol   \r\n2 Utility 1.4 aircond… Chevrolet         2015  198000 114900 Petrol   \r\n3 Clio Excellent cond… Renault           2019   55000 160000 Petrol   \r\n4 Ranger Excellent co… Ford              2017  107000 299900 Diesel   \r\n# … with 4 more variables: transmission <chr>, dealership <chr>,\r\n#   city_town <chr>, province <chr>\r\n\r\nDATA PREPROCESSING\r\nWe would like to fit a model to better understand the determinants of vehicle prices. Here, pre-processing is important is especially important. Tidymodels and the textrecipes offer a range of functions to handle the whole modelling workflow. Below, are a number of pre-processing steps, firstly we use the unnest_tokens function from the tidytext package to process the the car_name variable. Thereafter, we handle the numerical values by applying a logarithm to outcome variable and standardising mileage. Finally, we use step_tokenize, step_tokenfilter and step_tf to tokenise, filter the those tokens and ultimately convert the tokens to a term frequency variables.\r\n\r\n\r\nUseful_Car_Names <- Car_Data %>% \r\n  unnest_tokens(car_name,\r\n                output=\"car_name\") %>% \r\n  group_by(vehicle_manufacturer,car_name) %>% \r\n  summarise(n(),.groups = \"drop\") %>% \r\n  arrange(desc(`n()`)) %>% \r\n  anti_join(stop_words %>% \r\n              rename(car_name=word)) %>% \r\n  filter(!str_detect(car_name,\"\\\\d{1,}\"))\r\n\r\nCar_Data <- Car_Data %>% \r\n  unnest_tokens(car_name,output = \"car_name\") %>% \r\n  semi_join(Useful_Car_Names %>% \r\n              select(car_name,vehicle_manufacturer)) %>%\r\n  group_by(across(-car_name)) %>% \r\n  summarise(car_name = as.character(list(c(car_name))),\r\n            .groups = \"drop\") %>% \r\n  mutate(car_name = str_replace(car_name,\r\n                                'c[[:punct:]]{2,}',\"\"),\r\n         car_name = str_replace_all(car_name,\r\n                                    '\\\\\"',\"\"),\r\n         car_name = str_replace_all(car_name,\r\n                                    '[[:punct:]]{1,}$',\"\"),\r\n         age = 2021-year)\r\nCar_Data <- Car_Data %>% \r\n  mutate(across(c(car_name,dealership,city_town),\r\n                .fns = as_factor))\r\n\r\nNew_Car_Data <- recipe(price ~ .,data = Car_Data) %>% \r\n  step_log(all_outcomes()) %>%\r\n  step_normalize(mileage) %>% \r\n  step_tokenize(c(dealership,city_town,car_name)) %>%\r\n  step_tokenfilter(c(dealership,city_town,car_name)) %>%\r\n  step_tf(c(dealership,city_town,car_name)) %>% \r\n  step_dummy(c(vehicle_manufacturer,province,\r\n               fuel_type,transmission)) %>% \r\n  step_nzv(all_predictors()) %>% \r\n  prep() %>% \r\n  bake(Car_Data)\r\n\r\n\r\n\r\nLASSO IT ONCE, LASSO IT UNTIL YOU CAN ALSO NO MORE\r\nThe resulting dataset contains 59417 rows across 27 variables. Given the dimension above, it prudent to do some additional feature select. LASSO regression helps with variable selection. In turn, we use the LASSO regression results to filter for the appropriate variables. The final variable set yields 24 predictor variables. The code below contains all details the LASSO implementation and subsequent filtering.\r\n\r\n\r\nNew_Car_Data <- New_Car_Data %>%\r\n  select(-year)\r\n\r\nCar_split <- initial_split(New_Car_Data)\r\nCar_Training <- training(Car_split)\r\nCar_Test <- testing(Car_split)\r\n\r\nX <- model.matrix(price~.,Car_Training)[,-1]\r\nY <- Car_Training$price\r\nlasso_model <- glmnet(x = X,y=Y,\r\n       alpha=1)\r\n\r\nvariable_extractor <- function(a_list){\r\n  min_lambda <- data.frame(best_lambda =a_list[[\"lambda\"]]==min(a_list[[\"lambda\"]]))\r\n  min_lambda <- cbind.data.frame(data.frame(index = rownames(min_lambda)),\r\n                                 min_lambda)\r\n  min_lambda <- min_lambda %>% \r\n    filter(best_lambda == TRUE)\r\n  min_lambda <- as.double(unique(min_lambda$index))\r\n  lasso_variables <-\r\n    as.matrix(coef(a_list))|>data.frame()\r\n  \r\n  lasso_variables <- cbind.data.frame(variables = rownames(lasso_variables),\r\n                                      lasso_variables)\r\n  \r\n  lasso_variables <- tibble(lasso_variables)\r\n  lasso_variables <- lasso_variables[,c(1,min_lambda+1)]\r\n  names(lasso_variables) <- c(\"variable\",\"importance\")\r\n  lasso_variables <- lasso_variables %>% \r\n    filter(variable != \"(Intercept)\",\r\n           importance != 0.00000000) %>% \r\n    arrange(desc(importance))\r\n\r\n  return(lasso_variables)\r\n}\r\n\r\nVariables <- variable_extractor(lasso_model)\r\nCar_Training <- Car_Training[,c(\"price\",Variables$variable)]\r\nCar_Test <- Car_Test[,c(\"price\",Variables$variable)]\r\n\r\n\r\n\r\nCROSS VALIDATION\r\nBefore fitting to the test dataset, it worth investigating whether our model performs well against “shuffled” dataset of our training data. Fortunately, tidymodels and parsnip contain several functions to assist with the exercise.\r\nHere, we use the vfold_cv function to split our training data into random splits of equal size. Next, we use workflow to fit a linear model on the random splits. Subsequently, we plot the r-squares across all the folds.\r\nUltimately, cross validation helps us understand the performance of our model set of datasets by iterating through the training and test sample of each fold. The code below illustrates an implementation of cross validation.\r\n\r\n\r\nCar_Training_cv <- vfold_cv(Car_Training)\r\n\r\nlinear_model <- linear_reg() %>% \r\n  set_engine(\"lm\")\r\n\r\ncv_outcomes <- workflow() %>% \r\n  add_model(linear_model) %>% \r\n  add_formula(price ~.) %>% \r\n  fit_resamples(Car_Training_cv) %>% \r\n  select(id,.metrics) %>% \r\n  unnest(.metrics) %>% \r\n  filter(.metric == \"rsq\") %>% \r\n  select(id,.metric,.estimator,.estimate)\r\n\r\ncv_plot <- cv_outcomes %>%  \r\n  ggplot(aes(id,.estimate,group=1,fill=id))+\r\n  geom_col(show.legend = FALSE,alpha=0.8)+\r\n  geom_text(aes(label=round(.estimate,2)))+\r\n  coord_flip()+\r\n  labs(title = \"Cross Validation Results\",\r\n       subtitle = \"Car Prices Linear Model: R-Square across 10 folds\",\r\n       x=NULL,\r\n       y = \"R-Square\")+\r\n  theme(plot.title = element_text(family = \"Arial Narrow\",\r\n                                  hjust = 0.5),\r\n        plot.subtitle = element_text(family = \"Arial Narrow\",\r\n                                     hjust = 0.5,face = \"italic\"))\r\n\r\n\r\n\r\n\r\n\r\n\r\nTESTING PERFORMANCE OF A OUT-OF-SAMPLE SET\r\nOur model had an mean r-square of 0.62. Indicating that 62% of the variation in vehicle prices is explained by the variables in our dataset. To test whether the r-square remains stable on an unseen dataset, we fit the model to our test sample. The table below illustrates the results of linear regression below.\r\n\r\n\r\n \r\n\r\n\r\nprice\r\n\r\n\r\nPredictors\r\n\r\n\r\nEstimates\r\n\r\n\r\nstd. Beta\r\n\r\n\r\nCI\r\n\r\n\r\nstandardized CI\r\n\r\n\r\np\r\n\r\n\r\n(Intercept)\r\n\r\n\r\n13.39\r\n\r\n\r\n0.00\r\n\r\n\r\n13.36 – 13.42\r\n\r\n\r\n-0.01 – 0.01\r\n\r\n\r\n<0.001\r\n\r\n\r\nvehicle manufacturerMercedes Benz\r\n\r\n\r\n0.34\r\n\r\n\r\n0.13\r\n\r\n\r\n0.31 – 0.37\r\n\r\n\r\n0.12 – 0.14\r\n\r\n\r\n<0.001\r\n\r\n\r\nvehicle manufacturer BMW\r\n\r\n\r\n0.27\r\n\r\n\r\n0.09\r\n\r\n\r\n0.24 – 0.30\r\n\r\n\r\n0.08 – 0.10\r\n\r\n\r\n<0.001\r\n\r\n\r\ntf car name tsi\r\n\r\n\r\n0.20\r\n\r\n\r\n0.07\r\n\r\n\r\n0.17 – 0.23\r\n\r\n\r\n0.06 – 0.09\r\n\r\n\r\n<0.001\r\n\r\n\r\nvehicle manufacturerToyota\r\n\r\n\r\n0.20\r\n\r\n\r\n0.11\r\n\r\n\r\n0.18 – 0.23\r\n\r\n\r\n0.10 – 0.12\r\n\r\n\r\n<0.001\r\n\r\n\r\ntf car name double\r\n\r\n\r\n0.13\r\n\r\n\r\n0.05\r\n\r\n\r\n0.09 – 0.17\r\n\r\n\r\n0.04 – 0.07\r\n\r\n\r\n<0.001\r\n\r\n\r\nvehicle manufacturerVolkswagen\r\n\r\n\r\n0.10\r\n\r\n\r\n0.05\r\n\r\n\r\n0.06 – 0.13\r\n\r\n\r\n0.03 – 0.07\r\n\r\n\r\n<0.001\r\n\r\n\r\ntf city town pretoria\r\n\r\n\r\n0.01\r\n\r\n\r\n0.01\r\n\r\n\r\n-0.01 – 0.03\r\n\r\n\r\n-0.00 – 0.02\r\n\r\n\r\n0.159\r\n\r\n\r\nvehicle manufacturer Ford\r\n\r\n\r\n0.05\r\n\r\n\r\n0.02\r\n\r\n\r\n0.03 – 0.07\r\n\r\n\r\n0.01 – 0.03\r\n\r\n\r\n<0.001\r\n\r\n\r\ntf car name cab\r\n\r\n\r\n0.02\r\n\r\n\r\n0.01\r\n\r\n\r\n-0.02 – 0.05\r\n\r\n\r\n-0.01 – 0.02\r\n\r\n\r\n0.329\r\n\r\n\r\nmileage\r\n\r\n\r\n-1.39\r\n\r\n\r\n-0.18\r\n\r\n\r\n-1.51 – -1.27\r\n\r\n\r\n-0.19 – -0.16\r\n\r\n\r\n<0.001\r\n\r\n\r\nvehicle manufacturerNissan\r\n\r\n\r\n0.01\r\n\r\n\r\n0.00\r\n\r\n\r\n-0.02 – 0.04\r\n\r\n\r\n-0.01 – 0.01\r\n\r\n\r\n0.637\r\n\r\n\r\nprovince Western Cape\r\n\r\n\r\n-0.01\r\n\r\n\r\n-0.01\r\n\r\n\r\n-0.03 – 0.01\r\n\r\n\r\n-0.02 – 0.00\r\n\r\n\r\n0.273\r\n\r\n\r\ntf dealership cars\r\n\r\n\r\n-0.00\r\n\r\n\r\n-0.00\r\n\r\n\r\n-0.02 – 0.02\r\n\r\n\r\n-0.01 – 0.01\r\n\r\n\r\n0.781\r\n\r\n\r\nprovince Kwazulu Natal\r\n\r\n\r\n-0.01\r\n\r\n\r\n-0.01\r\n\r\n\r\n-0.03 – 0.01\r\n\r\n\r\n-0.01 – 0.00\r\n\r\n\r\n0.289\r\n\r\n\r\ntf dealership motors\r\n\r\n\r\n-0.00\r\n\r\n\r\n-0.00\r\n\r\n\r\n-0.02 – 0.01\r\n\r\n\r\n-0.01 – 0.01\r\n\r\n\r\n0.594\r\n\r\n\r\nvehicle manufacturerHyundai\r\n\r\n\r\n-0.05\r\n\r\n\r\n-0.02\r\n\r\n\r\n-0.07 – -0.02\r\n\r\n\r\n-0.03 – -0.01\r\n\r\n\r\n0.001\r\n\r\n\r\ntf dealership toyota\r\n\r\n\r\n-0.09\r\n\r\n\r\n-0.03\r\n\r\n\r\n-0.11 – -0.06\r\n\r\n\r\n-0.04 – -0.02\r\n\r\n\r\n<0.001\r\n\r\n\r\ntf car name dr\r\n\r\n\r\n-0.09\r\n\r\n\r\n-0.04\r\n\r\n\r\n-0.11 – -0.07\r\n\r\n\r\n-0.05 – -0.03\r\n\r\n\r\n<0.001\r\n\r\n\r\nage\r\n\r\n\r\n-0.06\r\n\r\n\r\n-0.41\r\n\r\n\r\n-0.06 – -0.06\r\n\r\n\r\n-0.42 – -0.39\r\n\r\n\r\n<0.001\r\n\r\n\r\ntf city town johannesburg\r\n\r\n\r\n-0.14\r\n\r\n\r\n-0.06\r\n\r\n\r\n-0.16 – -0.12\r\n\r\n\r\n-0.07 – -0.05\r\n\r\n\r\n<0.001\r\n\r\n\r\ntf car name polo\r\n\r\n\r\n-0.11\r\n\r\n\r\n-0.05\r\n\r\n\r\n-0.15 – -0.08\r\n\r\n\r\n-0.07 – -0.04\r\n\r\n\r\n<0.001\r\n\r\n\r\ntf car name auto\r\n\r\n\r\n-0.29\r\n\r\n\r\n-0.22\r\n\r\n\r\n-0.31 – -0.27\r\n\r\n\r\n-0.23 – -0.20\r\n\r\n\r\n<0.001\r\n\r\n\r\nfuel type Petrol\r\n\r\n\r\n-0.40\r\n\r\n\r\n-0.27\r\n\r\n\r\n-0.42 – -0.38\r\n\r\n\r\n-0.28 – -0.26\r\n\r\n\r\n<0.001\r\n\r\n\r\ntransmission Manual\r\n\r\n\r\n-0.70\r\n\r\n\r\n-0.51\r\n\r\n\r\n-0.73 – -0.68\r\n\r\n\r\n-0.53 – -0.50\r\n\r\n\r\n<0.001\r\n\r\n\r\nObservations\r\n\r\n\r\n14855\r\n\r\n\r\nR2 / R2 adjusted\r\n\r\n\r\n0.678 / 0.677\r\n\r\n\r\nAccording to the results above, statistically significant variables include the vehicle manufacturer, vehicle name,vehicle age,transmission_type and fuel_type. Top among these are Mercedes Benz, BMW,Toyota and Volkswagen. Vehicles with the terms such as: “tsi”,“double”,“cab”,“dr” and “auto”. Interesting, “tsi” is a fuel type designation among Volkswagen group vehicles. Similarly, “double” and “cab” usually denote the bakkie (pickup truck) segment in South Africa. Other vehicle segment key word is “dr” which usually indicate a coupe or two-door saloon vehicle.\r\nCONCLUSION\r\nIn example, we have found the determinants of vehicle prices from the scraped dataset. The results are in line with vehicle sales in South Africa. Mercedes Benz, BMW, Toyota and Volkswagen, Ford and Hyundai vehicles constantly feature among top selling vehicles in South Africa. As expected, vehicle age and vehicle mileage are statistically significant factors that influence prices. To enhance the analysis, it may be worthwhile to scrape more variables such as vehicle description, listing date, options list, vehicle conditions and colour.\r\nREFERENCE\r\nWickham et al.,2019. Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686\r\nSam Firke, 2021. janitor: Simple Tools for Examining and Cleaning Dirty Data. R package version 2.1.0. https://CRAN.R-project.org/package=janitor\r\nHadley Wickham and Jennifer Bryan, 2019. readxl: Read Excel Files. R package version 1.3.1. https://CRAN.R-project.org/package=readxl\r\nJeroen Ooms, 2021. writexl: Export Data Frames to Excel ‘xlsx’ Format. R package version 1.4.0. https://CRAN.R-project.org/package=writexl\r\nJeffrey B. Arnold. 2021. ggthemes: Extra Themes, Scales and Geoms for ‘ggplot2’. R package version 4.2.4. https://CRAN.R-project.org/package=ggthemes\r\nKuhn et al., 2020. Tidymodels: a collection of packages for modeling and machine learning using tidyverse principles. https://www.tidymodels.org\r\nEmil Hvitfeldt. 2021. textrecipes: Extra ‘Recipes’ for Text Processing. R package version 0.4.1. https://CRAN.R-project.org/package=textrecipes\r\nSilge J, Robinson, D. 2016. “tidytext: Text Mining and Analysis Using Tidy Data Principles in R.” JOSS, 1(3). doi: 10.21105/joss.00037. https://doi.org/10.21105/joss.00037\r\nJerome Friedman, Trevor Hastie, Robert Tibshirani. 2010. Regularization Paths for Generalized Linear Models via Coordinate Descent. Journal of Statistical Software, 33(1), 1-22. https://www.jstatsoft.org/v33/i01/\r\nJulia Silge, Fanny Chow, Max Kuhn and Hadley Wickham. 2021. rsample: General Resampling Infrastructure. R package version 0.1.1. https://CRAN.R-project.org/package=rsample\r\nMax Kuhn and Davis Vaughan (2021). parsnip: A Common API to Modeling and Analysis Functions. https://parsnip.tidymodels.org, https://github.com/tidymodels/parsnip\r\nLüdecke D. 2021. sjPlot: Data Visualization for Statistics in Social Science. R package version 2.8.10. https://CRAN.R-project.org/package=sjPlot\r\nLüdecke D. 2021. sjlabelled: Labelled Data Utility Functions (Version 1.1.8). doi: 10.5281/zenodo.1249215. https://doi.org/10.5281/zenodo.1249215.\r\n\r\n\r\n\r\n",
      "last_modified": "2022-04-09T16:49:29+02:00"
    },
    {
      "path": "index.html",
      "title": "Sivuyile Nzimeni",
      "author": [],
      "contents": "\r\n\r\n          \r\n          \r\n          Sivuyile Nzimeni\r\n          \r\n          \r\n          Home\r\n          \r\n          \r\n          Posts\r\n           \r\n          ▾\r\n          \r\n          \r\n          Ask A Manager Survey\r\n          Scraping DBE School Data\r\n          State of Capture Part 1: Notes\r\n          South African Car Prices\r\n          \r\n          \r\n          ☰\r\n          \r\n          \r\n      \r\n        \r\n          \r\n            \r\n              \r\n            \r\n              Sivuyile Nzimeni\r\n            \r\n            \r\n              \r\n                \r\n                    \r\n                      \r\n                        LinkedIn\r\n                      \r\n                    \r\n                  \r\n                                    \r\n                    \r\n                      \r\n                        Twitter\r\n                      \r\n                    \r\n                  \r\n                                    \r\n                    \r\n                      \r\n                        Email\r\n                      \r\n                    \r\n                  \r\n                                  \r\n            \r\n          \r\n        \r\n        \r\n        \r\n          \r\n            I am a Data Analyst and Teaching and Learning Coordinator for the Faculty of Economic and Management Sciences at the University of the Free State. Previously worked as a part-time lecturer (Personal Selling), Research Assistant and Intern at the same institution. I have a demonstrated history of working in the higher education industry with expertise in managing a large cohort of employees, Coordinating software development, Data Analysis Financial management, Monitoring and Evaluation, Report Writing and Presentation. In addition, I am skilled in the R Programming Language, Python, KNIME and Julia Programming language among others.\r\n            \r\n            Qualifications\r\n            2016: Bachelor of Commerce (Honours) with specialisation in Entrepreneurial Management (University of the Free State)\r\n            2015: Bachelor of Arts majoring in Philosophy and Management (University of the Free State)\r\n            2011: National Senior Certificate (Hoerskool De Vos Malan)\r\n            \r\n            \r\n            Certifications\r\n            Completed Certifications\r\n            Year\r\n            Month\r\n            Course Description\r\n            Provider\r\n            2021\r\n            Sept\r\n            Learning Julia (Programming Language)\r\n            LinkedIn Learning\r\n            2021\r\n            Aug\r\n            Artificial Intelligence Tools and Concepts\r\n            LinkedIn\r\n            Learning\r\n            2021\r\n            Jun\r\n            Python for Everybody Specialisation\r\n            Coursera\r\n            2021\r\n            May\r\n            PHP Essential Training\r\n            LinkedIn Learning\r\n            2021\r\n            Mar\r\n            Python Data Structures\r\n            Coursera\r\n            2021\r\n            Feb\r\n            Programming for Everybody(Getting Started with Python)\r\n            Coursera\r\n            2020\r\n            Oct\r\n            Advertising on Facebook: Advanced\r\n            LinkedIn Learning\r\n            2020\r\n            Sept\r\n            Developing Data Products\r\n            Coursera\r\n            2020\r\n            Sept\r\n            PostreSQL Essential Training\r\n            LinkedIn Learning\r\n            2020\r\n            Sept\r\n            Practical Machine Learning\r\n            Coursera\r\n            2020\r\n            Aug\r\n            Advanced R Programming\r\n            Coursera\r\n            2020\r\n            Jun\r\n            Regression Models\r\n            Coursera\r\n            2020\r\n            Apr\r\n            Data Visualisation in R with ggplot2\r\n            LinkedIn Learning\r\n            2020\r\n            Jan\r\n            R Statistics Essential Training\r\n            LinkedIn\r\n            Learning\r\n            2019\r\n            Dec\r\n            The R Programming Environment\r\n            Coursera\r\n            2017\r\n            Dec\r\n            Supplemental Instruction Supervisor Training Workshop\r\n            Nelson Mandela University( The Supplemental Instruction National Office)\r\n            2017\r\n            Mar\r\n            Advanced Project Management (NQF Level 5)\r\n            Extribyte (Pty) Ltd\r\n            Public ServiceSector Education & Training Authority\r\n            \r\n            \r\n            Skills\r\n            Process Automation\r\n            Data Analysis\r\n            Management\r\n            Customer Service\r\n            Big Data\r\n            Project Management\r\n            Database Administration\r\n            Data Visualisation\r\n            Web Application\r\n            Artificial Intelligence\r\n            \r\n            \r\n            Technologies\r\n            Microsoft365 (Excel,Word,Powerpoint,OneDrive,Sharepoint etc.)\r\n            R Programming\r\n            Python Programming\r\n            Julia Programming\r\n            MySQL\r\n            PostgreSQL\r\n            Blackboard\r\n            PeopleSoft\r\n            Facebook Marketing\r\n            Survey Data Collection Software (e.g. Questback, SurveyMonkey, GoogleForms etc.)\r\n            \r\n            \r\n            Publications\r\n            Nzimeni, S. Smit, AVA. 2018. ‘Is the quality of education impacting the global competitiveness of the South African business environment?’ 30th Annual Conference of the South African Institute of Management Scientists: Conference Proceedings, Stellenbosch University, Stellebosch, 16 - 19 September 2018.\r\n            Nzimeni, S. 2019. ‘Enrolment versus Attendance: A preliminary investigation into the cost of tutorials’. Siyaphumelela 2019: A Saide project. Johannesburg, 25 - 27 June 2019.\r\n            Muller, A. Nzimeni, S. Janse van Vuuren, Corlia. 2021. ‘Curriculum enhancement: reflections on the use of data, holistic student support and disciplinary skills development on a decade-long transformative journey’. 2021 University of the Free State Annual Teaching and Learning Conference.\r\n            \r\n          \r\n        \r\n      \r\n    \r\n\r\n    \r\n      \r\n        \r\n          \r\n            \r\n              \r\n            \r\n              Sivuyile Nzimeni\r\n            \r\n            \r\n              \r\n                \r\n                                    \r\n                    \r\n                      LinkedIn\r\n                    \r\n                  \r\n                                    \r\n                    \r\n                      Twitter\r\n                    \r\n                  \r\n                                    \r\n                    \r\n                      Email\r\n                    \r\n                  \r\n                                  \r\n              \r\n            \r\n            \r\n              I am a Data Analyst and Teaching and Learning Coordinator for the Faculty of Economic and Management Sciences at the University of the Free State. Previously worked as a part-time lecturer (Personal Selling), Research Assistant and Intern at the same institution. I have a demonstrated history of working in the higher education industry with expertise in managing a large cohort of employees, Coordinating software development, Data Analysis Financial management, Monitoring and Evaluation, Report Writing and Presentation. In addition, I am skilled in the R Programming Language, Python, KNIME and Julia Programming language among others.\r\n              \r\n              Qualifications\r\n              2016: Bachelor of Commerce (Honours) with specialisation in Entrepreneurial Management (University of the Free State)\r\n              2015: Bachelor of Arts majoring in Philosophy and Management (University of the Free State)\r\n              2011: National Senior Certificate (Hoerskool De Vos Malan)\r\n              \r\n              \r\n              Certifications\r\n              Completed Certifications\r\n              Year\r\n              Month\r\n              Course Description\r\n              Provider\r\n              2021\r\n              Sept\r\n              Learning Julia (Programming Language)\r\n              LinkedIn Learning\r\n              2021\r\n              Aug\r\n              Artificial Intelligence Tools and Concepts\r\n              LinkedIn\r\n              Learning\r\n              2021\r\n              Jun\r\n              Python for Everybody Specialisation\r\n              Coursera\r\n              2021\r\n              May\r\n              PHP Essential Training\r\n              LinkedIn Learning\r\n              2021\r\n              Mar\r\n              Python Data Structures\r\n              Coursera\r\n              2021\r\n              Feb\r\n              Programming for Everybody(Getting Started with Python)\r\n              Coursera\r\n              2020\r\n              Oct\r\n              Advertising on Facebook: Advanced\r\n              LinkedIn Learning\r\n              2020\r\n              Sept\r\n              Developing Data Products\r\n              Coursera\r\n              2020\r\n              Sept\r\n              PostreSQL Essential Training\r\n              LinkedIn Learning\r\n              2020\r\n              Sept\r\n              Practical Machine Learning\r\n              Coursera\r\n              2020\r\n              Aug\r\n              Advanced R Programming\r\n              Coursera\r\n              2020\r\n              Jun\r\n              Regression Models\r\n              Coursera\r\n              2020\r\n              Apr\r\n              Data Visualisation in R with ggplot2\r\n              LinkedIn Learning\r\n              2020\r\n              Jan\r\n              R Statistics Essential Training\r\n              LinkedIn\r\n              Learning\r\n              2019\r\n              Dec\r\n              The R Programming Environment\r\n              Coursera\r\n              2017\r\n              Dec\r\n              Supplemental Instruction Supervisor Training Workshop\r\n              Nelson Mandela University( The Supplemental Instruction National Office)\r\n              2017\r\n              Mar\r\n              Advanced Project Management (NQF Level 5)\r\n              Extribyte (Pty) Ltd\r\n              Public ServiceSector Education & Training Authority\r\n              \r\n              \r\n              Skills\r\n              Process Automation\r\n              Data Analysis\r\n              Management\r\n              Customer Service\r\n              Big Data\r\n              Project Management\r\n              Database Administration\r\n              Data Visualisation\r\n              Web Application\r\n              Artificial Intelligence\r\n              \r\n              \r\n              Technologies\r\n              Microsoft365 (Excel,Word,Powerpoint,OneDrive,Sharepoint etc.)\r\n              R Programming\r\n              Python Programming\r\n              Julia Programming\r\n              MySQL\r\n              PostgreSQL\r\n              Blackboard\r\n              PeopleSoft\r\n              Facebook Marketing\r\n              Survey Data Collection Software (e.g. Questback, SurveyMonkey, GoogleForms etc.)\r\n              \r\n              \r\n              Publications\r\n              Nzimeni, S. Smit, AVA. 2018. ‘Is the quality of education impacting the global competitiveness of the South African business environment?’ 30th Annual Conference of the South African Institute of Management Scientists: Conference Proceedings, Stellenbosch University, Stellebosch, 16 - 19 September 2018.\r\n              Nzimeni, S. 2019. ‘Enrolment versus Attendance: A preliminary investigation into the cost of tutorials’. Siyaphumelela 2019: A Saide project. Johannesburg, 25 - 27 June 2019.\r\n              Muller, A. Nzimeni, S. Janse van Vuuren, Corlia. 2021. ‘Curriculum enhancement: reflections on the use of data, holistic student support and disciplinary skills development on a decade-long transformative journey’. 2021 University of the Free State Annual Teaching and Learning Conference.\r\n              \r\n            \r\n        \r\n      \r\n    \r\n\r\n    \r\n    \r\n    ",
      "last_modified": "2022-04-09T16:49:29+02:00"
    },
    {
      "path": "Scrape_DBE.html",
      "title": "Department of Basic Education: Schools Database",
      "description": "This post details the data scraping process for obtaining the schools database of from the Department of Basic Education in South Africa.\n",
      "author": [
        {
          "name": {},
          "url": "https://www.linkedin.com/in/sivuyile-nzimeni-98006ba0/"
        }
      ],
      "date": "December 30, 2021",
      "contents": "\r\n\r\nContents\r\nINTRODUCTION\r\nDATA SCRAPING\r\nDOWNLOADS, SO MANY DOWNLOADS.\r\nBRING YOUR BROOMS CAUSE IT’S A MESS!\r\n\r\nCONCLUSION\r\nREFERENCES\r\n\r\nINTRODUCTION\r\nA few years ago, I was a student pursuing Masters of Commerce degree. The topic had something to do with the relationship between Education, Labour and Business outcomes. My pursuit of the qualification is defunct. However, there are several artefacts worth writting up. In this post, we will discuss the South African Schools Database. The Department of Basic Education regularly publishes versions of the School Database including a number of notable variables such as the school’s location, contact information, number of learners and teachers etc. The data is published in a non-standardised matter. This makes it an interesting data wrangling task.\r\nDATA SCRAPING\r\nThe first hurdle is the volume of files publised on the DBE website. It is possible to download all 200 files by hand and save them to a directory of your choosing. However, such a process would be tedious and error prone(speaking from experience, ofcourse). The R-Programming language is a perfect companion for this task. To download the files, we can use two important packages, rvest and xml2.\r\n\r\n\r\nData_Sets <- read_html(\"https://www.education.gov.za/Programmes/EMIS/EMISDownloads.aspx\") %>% \r\n  html_elements(\"a\") %>% \r\n  html_attr(name = \"href\")\r\n\r\nData_Sets <- data.frame(dataset_links = Data_Sets) %>% \r\n  filter(str_detect(dataset_links,\"^[[:punct:]]Link\"),\r\n         str_detect(dataset_links,\"forcedownload\"))\r\n\r\nData_Sets <- Data_Sets %>% \r\n  mutate(dataset_links = paste0(\"https://www.education.gov.za/Programmes/EMIS/EMISDownloads\",\r\n                                dataset_links))\r\n\r\n\r\n\r\nFirstly, we specify the url on the read_html function. Thereafter, we use the html_elements function to point to the html tag of interest. In this case, we are interest in the “a” tag, specifically, the href (or link) attribute.\r\nWe store the result in a data.frame object and use a regular expression to filter for values that start with a punctuation followed by “Link” and values that contain the term “forcedownload”. Finally, we append the path to file (our base url). The resulting data.frame contains all 200 downloadable files.\r\nDOWNLOADS, SO MANY DOWNLOADS.\r\nWith the links in hand, we can tackle the next hurdle, downloading the files. Usually, we could use the commandline to download the files. For example, the single command below.\r\n\r\nwget -i some_text_file.txt\r\n\r\nHowever, the DBE datasets are saved as either xlsx or xls format with a prompt on click to download the file. There are probably ways around this issue. Luckily, xml2 has a convenient function to handle this issue. In the code below, we use a for-loop to download each file in our dataset and save them in a specified sub folder. To avoid a break in the for-loop when an error occurs, we add the try function. As an add-on, we print a statement after each download. Depending on your internet connection speed and the website’s response time, this script can take five minutes to download all the files.\r\n\r\n\r\nfor(i in seq_along(1:nrow(Data_Sets))){\r\n  try(download_xml(url = Data_Sets$dataset_links[[i]],\r\n               file = paste0(\"./Schools_Db/\",\"file_\",i,\".xlsx\")))\r\n  print(paste0(\"File \",i, \" downloaded \",\"proceeding to file \",i+1,\".\"))\r\n}\r\n\r\n\r\n\r\nBRING YOUR BROOMS CAUSE IT’S A MESS!\r\nAnother set of tasks to address is reading and cleaning the excel files. Using other software such as Excel or SPSS, these tasks would be cumbersome. Yet with R, Python or other programming languages, it possible handle more than one file at a time. Below, we use the readxl and purrr R packages to iteratively read and clean the files.\r\n\r\n\r\n# All_Excel_Reader --------------------------------------------------------\r\nall_excel <- function(path){\r\n  collect_sheets <- excel_sheets(path)\r\n  number_of_sheets <- 1:length(collect_sheets)\r\n  per_sheet <- list()\r\n  for(i in seq_along(number_of_sheets)){\r\n    per_sheet[[i]] <- read_xlsx(path = path,\r\n                                sheet = collect_sheets[i])\r\n  }\r\n  return(per_sheet)}\r\n# All_Masterlist ----------------------------------------------------------\r\nEDU_Dbs <- data.frame(master_list = list.files(path = \"./Schools_Db\",\r\n           full.names=TRUE,\r\n           pattern = \".xlsx\")) %>% \r\n  mutate(schools_db = map(master_list,all_excel))\r\n\r\nEDU_Dbs <- EDU_Dbs %>% \r\n  unnest(schools_db)\r\n\r\nEDU_Dbs$schools_db <- lapply(EDU_Dbs$schools_db,sapply,as.character)\r\n\r\nEDU_Dbs$schools_db <- lapply(EDU_Dbs$schools_db,as.data.frame)\r\n\r\nEDU_Dbs <- EDU_Dbs %>% \r\n  unnest(schools_db)\r\n\r\nEDU_Dbs <- EDU_Dbs %>% \r\n  clean_names()\r\n\r\n\r\n\r\nThe resulting data.frame contains hundreds of thousands of rows and nearly 60 columns. Interestingly, most of these variable are effectively differing naming conventions such as emisno = natemis = oldnatemis = newnatemis. The insistent naming conventions extend to other variables such as gps coordinates and centre details. The spectacularly unoptimised script is availablehere. The scraper script,cleaning script and downloaded xlsx files are all available on the this github report.\r\nCONCLUSION\r\nUsing R to clean data is a wise choice. This post highlighted an example of implementation on a relatively small dataset. The final dataset can be used to match school performance reports regularly published by the Department of Basic Education.\r\nREFERENCES\r\nWickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686\r\nSam Firke (2021). janitor: Simple Tools for Examining and Cleaning Dirty Data. R package version 2.1.0. https://CRAN.R-project.org/package=janitor\r\nHadley Wickham and Jennifer Bryan (2019). readxl: Read Excel Files. R package version 1.3.1. https://CRAN.R-project.org/package=readxl\r\nJeroen Ooms (2021). writexl: Export Data Frames to Excel ‘xlsx’ Format. R package version 1.4.0. https://CRAN.R-project.org/package=writexl\r\nHadley Wickham (2021). rvest: Easily Harvest (Scrape) Web Pages. R package version 1.0.2. https://CRAN.R-project.org/package=rvest\r\n\r\n\r\n\r\n",
      "last_modified": "2022-04-09T16:49:29+02:00"
    },
    {
      "path": "State_Capture_One.html",
      "title": "State of Capture Commission Report Part 1: Notes",
      "description": "This posts is the first installment of notes from reading the State of Capture Commission's Report Part 1. This post post focuses on the first few pages of the report. \n",
      "author": [
        {
          "name": {},
          "url": "https://www.linkedin.com/in/sivuyile-nzimeni-98006ba0/"
        }
      ],
      "date": "January 05, 2022",
      "contents": "\r\n\r\nContents\r\nBACKGROUND\r\nREADING THE REPORT\r\nNOTES\r\nSOUTH AFRICAN AIRWAYS\r\n\r\nCONCLUSION\r\n\r\nBACKGROUND\r\nOn 14 October 2016, the previous Public Protector, Adv Thuli Mandonsela, published the State of Capture Report. The famed public sector watchdog had a reputation for holding public officials accountable. The State of Capture report was no different.\r\nIt documented the pervasiveness of State Capture in the Jacob Zuma administrations. The report provided prima facie evidence of State Capture, including many public officials burning desire to visit the home of the notorious Gupta Brothers.\r\nThe report also lent credence to the assertion of several whistleblowers that Guptas were surreptitiously influencing key public-sector decisions. Most importantly, the report led to the Commission of Inquiry into State Capture.\r\nIn the years since, a flurry of litigation in the peripheral of State Capture, some directly related to the topic, ensued; Jacob Zuma resigned, the Adv Thuli Mandonsela completed her term as the Public Protector and moved on to Stellenbosch University, and the Commission commenced its work.\r\nOn 04 January 2022, the Commission published Volume 1 of 3 of its report. The 04 January 2022 report is a continuation of the initial report from the previous Public Protector. The Commission’s report provides comprehensive detail on the allegations of State Capture, investigating claims and issuing several findings against several parties.\r\nREADING THE REPORT\r\nThe 04 January 2022 report is the culmination of 430 hearings, 778 videos and 170 666 Affidavits and Statements, 3 171 summons issued to witness and 1 380 Requests For Information (State Capture.org.za 2022). Reading the report’s contents is important to understand the depth and breadth of the State Capture project. Beyond this, it is also important to read through the information to defend against disinformation and misinformation campaigns that may arise on social media especially considering the Bell Pottinger scandal.\r\nNOTES\r\nThis post attempts to summarise the report’s contents into layman’s language. It is also an attempt to find salient points throughout the report and ultimately to gain an in-depth understanding of the report.\r\nThe report opens with background information on the establishment of the Commission. It provides descriptive statistics on the work of the Commission and recounts the Commission’s mandate. The Commission heard evidence related to the following State-Owned Enterprises and Private Enterprises:\r\nSouth African Airways (SAA) and Subsidiaries\r\nBOSASA\r\nDenel\r\nEskom\r\nEstina Dairy Farm\r\nPRASA\r\nSABC\r\nSARS\r\nSSA\r\nTransnet.\r\nChapter 1 of the report focuses on SAA and its subsidiaries. Chapters 2, 3, and 4 focus on The New Age and its dealings with government departments and State-Owned Entities, South African Revenue Service and Public Procurement in South Africa, respectively. This post will focus on the first 140 pages of the report, with the remaining pages covered in subsequent posts.\r\nSOUTH AFRICAN AIRWAYS\r\nThe report is unambiguous about the entity’s state while Ms Dudu Myeni and Ms Kwinana served as board members. In short, the report asserts that SAA experienced a steady decline in quality and effectiveness. This decline is largely attributed to the tenures of Ms Myeni and Ms Kwinana. Throughout their terms, corruption and fraud were rampant at the institution. Those that opposed illegal conduct were victimised and eventually removed from their positions. The Commission also highlights failures by SAA auditors to detect fraud and corruption. The collapse also extends to SAA’s internal audit function. There was also a wholesale failure in governance within the SAA and its subsidiaries (see paragraphs 11 – 20 of the report).\r\nThe Commission is particularly scathing on the conduct of Ms Myeni, arguing that she created the hostile environment described above through “a mixture of negligence, incompetence and deliberate corrupt intent” to further the project of dismantling governance at the entity (see Paragraph 13 of the report).\r\nThe Commission also implicates several other stakeholders as enablers of Myeni’s conduct. These stakeholders include former President Jacob Zuma (see paragraph 14), former Ministers Gigaba and Brown (see paragraph 18). Finally, the Cabinet, the Executive of South Africa, is also implicated for yielding to the preferences of the President rather than the interests of State-Owned Enterprises. Ms Carolous (previous SAA Board Chair) detailed several instances where then Minister of Public Enterprises, Mr Malusi Gigaba, took steps to undermine the authority of the Board and affect the strategic outcomes of the entity. These actions include:\r\nExcluding the Board Chair from Communication\r\nPublicly denouncing the Board, calling them unpatriotic and incompetent\r\nDelaying submission of the Request for a Guarantee to Treasury\r\nMisleading the Board Chair about the timeline of the proposal to Treasury Pressuring SAA to close the commercially viable Mumbai route.\r\nAppointing Ms Dudu Myeni as Board Chair despite her poor attendance record at SAA Board Meetings. (see Paragraphs 39 – 68)\r\nThe report also reveals that Mr Siyabonga Mahlangu, then adviser to the Minister of Public Enterprises, had an unquenchable thirst to visit the Gupta household. Mr Mahlangu’s affections for the Saxonwold compound also included inviting others to the address.\r\nOne such invitee was then Acting Chief Executive Officer, Mr Kona. Mr Kona alleges that Mr Tony Gupta offered him a large amount of money, which he refused. At the same meeting, Mr Kona informed Mr Tony Gupta about allocating a tender to Lufthansa Consultancy. In addition, Mr Kona alleged that Mr Tony Gupta was livid about the tender allocation.\r\nAfter the visit, Mr Kona received a call from the Director-General of Public Enterprises, Mr Tshediso Matona. The Director-General expressed his displeasure on the tender allocation to Lufthansa Consultancy. The grievances of the Director-General were to the extent that the Department of Public Enterprises deemed it necessary to investigate the tender. The investigation found no irregularities associated with the tender. Despite the findings of the investigation, the Department of Public Enterprises refused the continuance of the tender.\r\nCONCLUSION\r\nThis is the tip of the iceberg. There several specific allegation against Ms Dudu Myeni and Ms Kwinana. These will be discussed in subsequent summaries (trying to keep the word count below 1000). For now, it clear that State Capture was (or is) present at South African Airways. The following post will detail specific incidents of how State Capture took hold of the entity with specific reference to the conduct of Ms Dudu Myeni.\r\n\r\n\r\n\r\n",
      "last_modified": "2022-04-09T16:49:29+02:00"
    },
    {
      "path": "Twitter_Sentiment.html",
      "title": "Predicting Twitter Sentiment",
      "description": "In this post, we will be working through a Kaggle Dataset to predict tweet sentiment.\n",
      "author": [
        {
          "name": "Sivuyile Nzimeni",
          "url": "https://sivuyilenzimeni.netlify.app"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\nINTRODUCTION\r\nIn this post, we will attempt to predict tweet sentiment based on\r\ndata from Kaggle.\r\nThe challenge here is to extract meaningful features from tweets which\r\nin turn can be used to predict sentiment. As usual, the aim the data\r\nwill be split into training and test set. We will use the training set\r\nto train our model(s) and evaluate model performance on the test\r\nset.\r\nDATA EXPLORATION\r\n\r\n\r\nTweets <- read_csv(file = \"./Tweets.csv\") %>% \r\n  clean_names()\r\n\r\nskimr::skim(Tweets)\r\n\r\n\r\n(#tab:Import_Data)Data summary\r\nName\r\nTweets\r\nNumber of rows\r\n27481\r\nNumber of columns\r\n4\r\n_______________________\r\n\r\nColumn type frequency:\r\n\r\ncharacter\r\n4\r\n________________________\r\n\r\nGroup variables\r\nNone\r\nVariable type: character\r\nskim_variable\r\nn_missing\r\ncomplete_rate\r\nmin\r\nmax\r\nempty\r\nn_unique\r\nwhitespace\r\ntext_id\r\n0\r\n1\r\n10\r\n10\r\n0\r\n27481\r\n0\r\ntext\r\n1\r\n1\r\n1\r\n141\r\n0\r\n27449\r\n0\r\nselected_text\r\n1\r\n1\r\n1\r\n141\r\n0\r\n22463\r\n0\r\nsentiment\r\n0\r\n1\r\n7\r\n8\r\n0\r\n3\r\n0\r\n\r\nIn the code-chuck above, we import the csv file using the\r\nread_csv from the reader package. Thereafter,\r\nwe use janitor::clean_names to standardise the column\r\nnames. Finally, we use skimr::skim function to get an\r\noverview of the data, summarising our dataframe. The dataframe has four\r\ncolumns, 1) text_id, 2) text, 3) selected_text and 4) sentiment. Only\r\ntwo columns contain a single missing value. Importantly, the sentiment\r\ncolumn has three unique values. Tweet sentiment is either neutral,\r\nnegative or positive. This an important feature in the dataset since\r\nsentiment can also be expressed a numeric value. Naturally, the\r\nrestriction to three values will have an influence in our modelling.\r\nBelow we explore the distribution of sentiment values.\r\n\r\n\r\n\r\n\r\n\r\nTweets <- Tweets %>% \r\n  mutate(text = str_to_lower(text),\r\n         sentiment = factor(sentiment))\r\n\r\n\r\n\r\n\r\n\r\nTweets <- Tweets %>% \r\n  select(-selected_text) %>% \r\n  unnest_tokens(input = text,\r\n                output = \"word\") %>% \r\n  filter(!str_detect(word,\"a{2,}|e{2,}|i{2,}|o{2,}|u{2,}\")) %>% \r\n  anti_join(data.frame(word =stopwords::data_stopwords_snowball[[\"en\"]])) %>%\r\n  filter(str_detect(word,\"[[:lower:]]{2,}\")) %>%\r\n  mutate(word = str_replace(word,\"[[:punct:]]{1,}\",\"\")|>str_trim(),\r\n         word = str_replace(word,\"[[:digit:]]{1,}\",\"\")|>str_trim()) \r\n\r\n\r\n\r\n\r\n\r\nWord_Occurence <- count(Tweets,word,sort=TRUE,name = \"occurence\") %>% \r\n  filter(occurence > 5)\r\n\r\nTweets <- Tweets %>% \r\n  filter(word %in% c(Word_Occurence$word)) %>% \r\n  unique()\r\n\r\nTweets <- left_join(Tweets %>%\r\n  select(text_id,sentiment) %>% \r\n  unique(),\r\n  Tweets %>% \r\n  group_by(text_id) %>% \r\n  summarise(word = list_to_character(list(c(word))),\r\n            .groups = \"drop\"))\r\n\r\n\r\n\r\n\r\n\r\nTweets <- recipe(sentiment ~ word,data=Tweets) %>% \r\n  step_tokenize(all_predictors()) %>% \r\n  step_lda(word,num_topics = 4) %>% \r\n  step_normalize(all_predictors()) %>%  \r\n  themis::step_downsample(sentiment) %>% \r\n  prep() %>% \r\n  bake(Tweets)\r\n\r\nTweet_Train <- rsample::initial_split(Tweets,strata = sentiment)|> rsample::training()\r\nTweet_Test <- rsample::initial_split(Tweets,strata = sentiment)|> rsample::testing() \r\n\r\n\r\n\r\n\r\n\r\nrf_spec <- rand_forest(mtry = 3, trees = 5000) %>%\r\n  set_engine(\"randomForest\") %>%\r\n  set_mode(\"classification\")\r\n\r\nrf_fit <- rf_spec %>% \r\n  fit(sentiment~.,data=Tweet_Train)\r\n\r\nrf_results <- augment(rf_fit,Tweet_Train) %>%\r\n  conf_mat(truth = sentiment,\r\n           estimate = .pred_class)\r\n\r\n\r\n\r\n\r\n\r\nnb_spec <- naive_Bayes() %>% \r\n  set_engine(\"naivebayes\") %>% \r\n  set_mode(\"classification\")\r\n\r\nnb_fit <- nb_spec %>% \r\n  fit(sentiment~.,data=Tweet_Train)\r\n\r\nnb_results <-\r\naugment(nb_fit,Tweet_Train) %>% \r\n  conf_mat(truth = sentiment,\r\n            estimate = .pred_class)\r\n\r\n\r\n\r\n\r\n\r\nmlp_rec <- mlp(epochs = 30, hidden_units = 15, dropout = 0.1,\r\n               ) %>% \r\n  set_mode(\"classification\") %>% \r\n  set_engine(engine = \"nnet\")\r\n\r\nmlp_fit <- mlp_rec %>% \r\n  fit(sentiment ~.,data=Tweet_Train)\r\n\r\naugment(mlp_fit,Tweet_Train) %>% \r\n  recall(truth = sentiment,\r\n            estimate = .pred_class)\r\n\r\n\r\n# A tibble: 1 × 3\r\n  .metric .estimator .estimate\r\n  <chr>   <chr>          <dbl>\r\n1 recall  macro          0.349\r\n\r\n\r\n\r\nxgboost_spec <- boost_tree(\r\n) %>% \r\n  set_engine(\"xgboost\") %>% \r\n  set_mode(\"classification\")\r\n\r\nxgboost_fit <- xgboost_spec %>% \r\n  fit(sentiment~.,data=Tweet_Train)\r\n\r\nxgboost_results <- augment(xgboost_fit,Tweet_Train) %>% \r\n  accuracy(truth = sentiment,\r\n           estimate = .pred_class) %>% \r\n  mutate(method = \"xgboost\")\r\n\r\n\r\n\r\n\r\n\r\nmultinom_spec <- multinom_reg() %>% \r\n  set_engine(\"nnet\") %>% \r\n  set_mode(\"classification\")\r\n\r\nmultinom_fit <- multinom_spec %>% \r\n  fit(sentiment ~ ., data = Tweet_Train)\r\n\r\naugment(multinom_fit,Tweet_Train) %>% \r\n  accuracy(truth = sentiment,\r\n           estimate = .pred_class)\r\n\r\n\r\n# A tibble: 1 × 3\r\n  .metric  .estimator .estimate\r\n  <chr>    <chr>          <dbl>\r\n1 accuracy multiclass     0.395\r\n\r\n\r\n\r\n\r\n",
      "last_modified": "2022-05-03T17:14:07+02:00"
    }
  ],
  "collections": []
}
